roles:
  training.*:
    scheduling:
      require:
        - training
        - slurm
    cores: 2
    mem: cores * 3.5 # TODO: check multiplier
    params:
      nativeSpecification: "--nodes=1 --ntasks={cores} --ntasks-per-node={cores} --mem={mem*1024} --partition=training"
    rules:
    - match: |
        entity.tags.filter(tag_value='pulsar')
      cores: 4
      mem: cores * 3.5 # TODO: check multiplier
      scheduling:
        require:
          - pulsar  # require pulsar and training: only one place to go
          - training
        reject:
          - slurm # overcome require slurm, will this work?
    - match: |
        entity.tags.filter(tag_value='pulsar') and tool.id in ['unicycler'] # list of higher mem training tools
      cores: 8
      mem: cores * 3.5 # TODO: check multiplier
      scheduling:
        require:
          - pulsar  # require pulsar and training: only one place to go
          - training
        reject:
          - slurm # overcome require slurm
